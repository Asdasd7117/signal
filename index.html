<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>شارت Binance حقيقي</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; background-color: #1e1e1e; color: white; }
        #chart { width: 100%; height: 100vh; }
    </style>
</head>
<body>
    <div id="chart"></div>
    <script>
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            width: window.innerWidth,
            height: window.innerHeight,
            layout: {
                backgroundColor: '#1e1e1e',
                textColor: '#d1d4dc',
            },
            grid: {
                vertLines: { color: '#444' },
                horzLines: { color: '#444' },
            },
            crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
            rightPriceScale: { borderColor: '#555' },
            timeScale: { borderColor: '#555' },
        });

        const candleSeries = chart.addCandlestickSeries({
            upColor: '#4caf50',
            downColor: '#f44336',
            borderDownColor: '#f44336',
            borderUpColor: '#4caf50',
            wickDownColor: '#f44336',
            wickUpColor: '#4caf50',
        });

        // جلب بيانات الشموع من Binance
        async function fetchCandles(symbol='BTCUSDT', interval='1m', limit=100) {
            const url = `https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${interval}&limit=${limit}`;
            const response = await fetch(url);
            const data = await response.json();
            return data.map(d => ({
                time: d[0] / 1000, // Timestamp بالثواني
                open: parseFloat(d[1]),
                high: parseFloat(d[2]),
                low: parseFloat(d[3]),
                close: parseFloat(d[4]),
            }));
        }

        async function initChart() {
            const candles = await fetchCandles();
            candleSeries.setData(candles);
        }

        initChart();

        // تحديث تلقائي كل 5 ثواني
        setInterval(async () => {
            const candles = await fetchCandles();
            candleSeries.setData(candles);
        }, 5000);

        window.addEventListener('resize', () => {
            chart.resize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
